<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YUTorah Notes - Settings</title>
    <link rel="stylesheet" href="options.css">
</head>

<body>
    <div class="container">
        <header>
            <h1>‚öôÔ∏è YUTorah Notes Settings</h1>
            <p class="subtitle">Configure your extension to generate AI-powered notes from YUTorah shiurim</p>
        </header>

        <main>
            <!-- API Key Section -->
            <section class="card">
                <h2>üîë API Key Configuration</h2>

                <div class="info-box warning">
                    <p><strong>üí° Recommended: Use Your Own API Key</strong></p>
                    <p>For the best experience with unlimited requests and full privacy, we strongly recommend using
                        your own free Gemini API key.</p>
                    <p>The default mode is provided for <strong>demo and basic use only</strong> (3 requests/day
                        limit).</p>
                </div>

                <!-- Key Mode Selection -->
                <div class="form-group">
                    <label style="font-weight: bold; margin-bottom: 12px; display: block;">Choose API Key Mode:</label>

                    <!-- Default Mode Option -->
                    <div class="radio-option">
                        <input type="radio" id="modeDefault" name="keyMode" value="default">
                        <label for="modeDefault">
                            <strong>üéØ Default Keys (Demo Mode)</strong>
                            <br>
                            <small>Shared keys with 3 requests per day limit - for trying out the extension</small>
                        </label>
                    </div>

                    <!-- Usage Stats (shown when default mode is active) -->
                    <div id="usageStats" class="usage-stats" style="display: none;">
                        <div class="usage-bar-container">
                            <div class="usage-bar" id="usageBar"></div>
                        </div>
                        <div class="usage-text">
                            <span id="usageText">0 / 3 requests used today</span>
                            <span id="resetText">Resets at midnight</span>
                        </div>
                    </div>

                    <!-- Custom Mode Option -->
                    <div class="radio-option">
                        <input type="radio" id="modeCustom" name="keyMode" value="custom">
                        <label for="modeCustom">
                            <strong>‚≠ê My Own API Key (Recommended)</strong>
                            <br>
                            <small>Unlimited requests, full privacy, and better performance</small>
                        </label>
                    </div>
                </div>

                <!-- Custom API Key Input (shown when custom mode is selected) -->
                <div id="customKeySection" style="display: none;">
                    <div class="info-box">
                        <p><strong>üîí Privacy Guarantee:</strong></p>
                        <p>Your API key is stored <strong>locally in your browser only</strong>. The extension developer
                            has <strong>NO ACCESS</strong> to your key.</p>
                    </div>

                    <div class="form-group">
                        <label for="apiKey">Your Gemini API Key:</label>
                        <div class="input-group">
                            <input type="password" id="apiKey" placeholder="Enter your Gemini API key"
                                autocomplete="off">
                            <button id="toggleApiKey" class="btn-secondary" title="Show/Hide API Key">üëÅÔ∏è</button>
                        </div>
                        <small>Get your free API key from <a href="https://aistudio.google.com/app/apikey"
                                target="_blank">Google AI Studio</a></small>
                    </div>

                    <div class="button-group">
                        <button id="saveApiKey" class="btn-primary">Save API Key</button>
                        <button id="testApiKey" class="btn-secondary">Test Connection</button>
                        <button id="clearApiKey" class="btn-danger">Clear API Key</button>
                    </div>

                    <div id="apiKeyStatus" class="status-message"></div>
                </div>

                <!-- Save Mode Button -->
                <div class="button-group" style="margin-top: 16px;">
                    <button id="saveMode" class="btn-primary">Save Mode Selection</button>
                </div>
                <div id="modeStatus" class="status-message"></div>
            </section>

            <!-- How to Get API Key Section -->
            <section class="card">
                <h2>üìñ How to Get Your API Key</h2>

                <div class="info-box warning">
                    <p><strong>‚ö†Ô∏è IMPORTANT - Do NOT Use School/Institutional Email:</strong></p>
                    <ul>
                        <li><strong>Use a personal Gmail account</strong> (not your school or work email)</li>
                        <li>Institutional accounts often have restrictions that prevent API key creation</li>
                        <li>If you don't have a personal Gmail, create a free one at <a
                                href="https://accounts.google.com/signup" target="_blank">gmail.com</a></li>
                    </ul>
                </div>

                <ol class="instructions">
                    <li><strong>Sign in with a PERSONAL Google account</strong> (not school/work email)</li>
                    <li>Go to <a href="https://aistudio.google.com/app/apikey" target="_blank">Google AI Studio</a></li>
                    <li>Click the blue <strong>"Create API Key"</strong> button</li>
                    <li>Select <strong>"Create API key in new project"</strong> (recommended for first-time users)</li>
                    <li>Your API key will appear - click <strong>"Copy"</strong> to copy it</li>
                    <li>Paste it in the field above and click <strong>"Save API Key"</strong></li>
                    <li>Click <strong>"Test Connection"</strong> to verify it works</li>
                </ol>

                <div class="info-box">
                    <p><strong>üí° Tips:</strong></p>
                    <ul>
                        <li>The Gemini API has a generous free tier - perfect for personal use</li>
                        <li>Keep your API key private - don't share it with anyone</li>
                        <li>If you lose your key, you can always create a new one</li>
                    </ul>
                </div>

                <div class="info-box warning">
                    <p><strong>üîí Privacy Notice:</strong></p>
                    <ul>
                        <li>Your API key is stored locally in your browser's extension storage</li>
                        <li>The extension developer (the person who created this extension) has <strong>NO
                                ACCESS</strong> to your API key</li>
                        <li>Audio files are sent directly from your browser to Google's Gemini API</li>
                        <li>No data passes through any third-party servers</li>
                        <li>All notes are stored locally in your browser</li>
                    </ul>
                </div>
            </section>

            <!-- Custom Prompts Section -->
            <section class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <h2 style="margin: 0;">‚úèÔ∏è Custom Prompts</h2>
                    <button id="togglePrompts" class="btn-secondary" style="font-size: 0.9rem;">
                        üîß Advanced Options (Optional)
                    </button>
                </div>

                <div id="promptsSection" style="display: none;">
                    <div class="info-box">
                        <p><strong>‚ÑπÔ∏è Most users don't need this!</strong></p>
                        <p>The extension works great with the default prompts. Only customize if you want to change how
                            notes or transcripts are generated.</p>
                    </div>

                    <div class="form-group">
                        <label for="customNotesPrompt">Custom Notes Prompt (Optional):</label>
                        <textarea id="customNotesPrompt" rows="8"
                            placeholder="Leave blank to use default notes prompt"></textarea>
                        <small>This prompt will be used when generating notes. Hebrew terms will still be preserved in
                            Hebrew script.</small>
                    </div>

                    <div class="form-group">
                        <label for="customTranscriptPrompt">Custom Transcript Prompt (Optional):</label>
                        <textarea id="customTranscriptPrompt" rows="8"
                            placeholder="Leave blank to use default transcript prompt"></textarea>
                        <small>This prompt will be used when generating transcripts.</small>
                    </div>

                    <div class="button-group">
                        <button id="savePrompts" class="btn-primary">Save Prompts</button>
                        <button id="resetPrompts" class="btn-secondary">Reset to Default</button>
                    </div>

                    <div id="promptStatus" class="status-message"></div>
                </div>
            </section>

            <!-- Storage Management Section -->
            <section class="card">
                <h2>üíæ Storage Management</h2>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-label">Cached Notes</div>
                        <div class="stat-value" id="noteCount">-</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Storage Used</div>
                        <div class="stat-value" id="storageUsed">-</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Storage Available</div>
                        <div class="stat-value" id="storageAvailable">-</div>
                    </div>
                </div>

                <div class="button-group">
                    <button id="viewNotes" class="btn-secondary">View All Notes</button>
                    <button id="exportNotes" class="btn-secondary">Export Notes</button>
                    <button id="importNotes" class="btn-secondary">Import Notes</button>
                    <button id="clearCache" class="btn-danger">Clear All Notes</button>
                </div>

                <input type="file" id="importFile" accept=".json" style="display: none;">
            </section>

            <!-- About Section -->
            <section class="card">
                <h2>‚ÑπÔ∏è About</h2>
                <p><strong>YUTorah Notes</strong> v2.0.0</p>
                <p>Generate AI-powered notes and transcripts from YUTorah shiurim with one click.</p>
                <p>This extension is completely private - all processing happens between your browser and Google's
                    Gemini API.</p>
                <p class="footer-links">
                    <a href="https://github.com/brotblat2/yutorahnotesandtranscriber" target="_blank">GitHub</a> ‚Ä¢
                    <a href="mailto:shiurnotes@yahoo.com">Contact</a>
                </p>
            </section>
        </main>
    </div>

    <script src="storage.js"></script>
    <script src="options.js"></script>
</body>

</html>